!function(e){function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}var t={};n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},n.p="",n(n.s=4)}({4:function(e,n,t){"use strict";var o=JSON.parse(localStorage.getItem("results")),r=function(e){o=Object.assign({},o,e),localStorage.setItem("results",JSON.stringify(o))},l=document.getElementById("levels"),a=function(e,n){var t=new FormData;t.append("csrf_token",document.getElementById("csrf_token").value),Object.keys(e).forEach(function(n){t.append(n,e[n])}),fetch(window.location,{body:t,credentials:"same-origin",method:"POST"}).then(function(){"string"==typeof n&&(window.location=n)})};null!==l&&(r({greyscaleRampSteps:void 0}),l.addEventListener("change",function(){var e=l.value;"-"!==e?(r({greyscaleRampSteps:parseInt(e,10)}),a({levels:e,screen_colour_depth:screen.colorDepth,screen_height:screen.height,screen_width:screen.width},"name_colour.html")):r({greyscaleRampSteps:void 0})}));var i=document.getElementById("colour-circle"),u=document.getElementById("colour-id"),c=document.getElementById("colour-name"),d=document.getElementById("colour-name-form"),s=document.getElementById("colour-number"),m=document.getElementById("colour-vision-test-page"),v=document.getElementById("next-colour"),g=document.getElementById("response-time"),p=document.getElementById("start-time");if(null!==i&&null!==u&&null!==c&&null!==d&&null!==s&&null!==m&&null!==v&&null!==g&&null!==p){r({colours:void 0});var h=function(){fetch(COLOUR_NAME_TARGET_URL).then(function(e){return e.json()}).then(function(e){var n=e.b,t=e.g,o=e.id,r=e.r;i.style.backgroundColor="rgb("+r+", "+t+", "+n+")",u.value=o,p.value=performance.now()})},f=function(){var e={name:c.value,value:i.style.backgroundColor},n=o.colours?[].concat(function(e){if(Array.isArray(e)){for(var n=0,t=Array(e.length);n<e.length;n++)t[n]=e[n];return t}return Array.from(e)}(o.colours),[e]):[e];r({colours:n})};h(),c.addEventListener("input",function(){""===g.value&&(g.value=performance.now()-parseFloat(p.value))}),d.addEventListener("submit",function(e){e.preventDefault(),f(),a({name:c.value,response_time:parseFloat(g.value),target_id:u.value}),h(),c.value="",s.textContent="#"+(o.colours?o.colours.length+1:0),g.value="",c.focus()}),m.addEventListener("click",function(e){e.preventDefault(),""!==c.value?(f(),a({name:c.value,response_time:performance.now()-parseFloat(p.value),target_id:u.value},"colour_vision.html")):window.location="colour_vision.html"});var y={height:window.innerHeight,width:window.innerWidth};window.addEventListener("resize",function(){var e=window.innerHeight,n=document.scrollingElement.scrollTop,t=window.innerWidth;if(c===document.activeElement&&e<y.height&&t===y.width){var o=c.getBoundingClientRect(),r=o.height,l=o.top+n-e+r+10;document.scrollingElement.scrollTop=l;var a=0,i=function e(){document.scrollingElement.scrollTop!==l&&(document.scrollingElement.scrollTop=l),(a+=1)<20&&requestAnimationFrame(e)};requestAnimationFrame(i)}y={height:e,width:t}})}var E=document.getElementById("appearance");null!==E&&(r({appearance:void 0}),E.addEventListener("change",function(){var e=E.value;"-"!==e?(r({appearance:e}),a({square_disappeared:e},"observer_information.html")):r({appearance:void 0})}));var _=document.getElementById("age"),I=document.getElementById("gender"),w=document.getElementById("colour_experience"),B=document.getElementById("language_experience"),C=document.getElementById("education_level"),L=document.getElementById("country_raised"),b=document.getElementById("country_resident"),x=document.getElementById("ambient_light"),k=document.getElementById("screen_light"),S=document.getElementById("screen_distance"),O=document.getElementById("thank-you-page");null!==_&&null!==S&&null!==C&&null!==k&&null!==w&&null!==I&&null!==L&&null!==B&&null!==x&&null!==b&&null!==O&&(r({age:-1,distance:-1,educationalLevel:"",environment:"",experience:"",gender:"",homeCountry:"",languageSkills:"",lightConditions:"",residentCountry:""}),_.addEventListener("change",function(){var e=_.value;r("-"!==e?{age:parseInt(e,10)}:{age:void 0})}),S.addEventListener("change",function(){var e=S.value;r("-"!==e?{distance:e}:{distance:void 0})}),C.addEventListener("change",function(){var e=C.value;r("-"!==e?{educationalLevel:e}:{educationalLevel:void 0})}),k.addEventListener("change",function(){var e=k.value;r("-"!==e?{environment:e}:{environment:void 0})}),w.addEventListener("change",function(){var e=w.value;r("-"!==e?{experience:e}:{experience:void 0})}),I.addEventListener("change",function(){var e=I.value;r("-"!==e?{gender:e}:{gender:void 0})}),L.addEventListener("change",function(){var e=L.value;r("-"!==e?{homeCountry:e}:{homeCountry:void 0})}),B.addEventListener("change",function(){var e=B.value;r("-"!==e?{languageSkills:e}:{languageSkills:void 0})}),x.addEventListener("change",function(){var e=x.value;r("-"!==e?{lightConditions:e}:{lightConditions:void 0})}),b.addEventListener("change",function(){var e=b.value;r("-"!==e?{residentCountry:e}:{residentCountry:void 0})}),O.addEventListener("click",function(e){e.preventDefault(),a({age:o.age,ambient_light:o.lightConditions,colour_experience:o.experience,country_raised:o.homeCountry,country_resident:o.residentCountry,education_level:o.educationalLevel,gender:o.gender,language_experience:o.languageSkills,screen_distance:o.distance,screen_light:o.environment},O.href)}));var j=document.getElementById("thank-you-text"),A=document.getElementById("results");if(null!==j&&null!==A){var T=o.colours;T&&(fetch("/experiment/response_percentage?count="+T.length).then(function(e){return e.json()}).then(function(e){var n=Math.round(e.top_percentage);j.textContent="Thank you for participating. You are in the "+n+"% top colournamers. Feel free to share it with your friends."}),Promise.all(Object.keys(T).map(function(e){var n=T[e],t=n.name,o=n.value,r=document.createElement("div"),l=document.createElement("li"),a=document.createElement("span"),i=document.createElement("span");r.style.backgroundColor=o,a.className="white",a.textContent=t;var u=o.match(/rgb\(([0-9]+),\s([0-9]+),\s([0-9]+)\)/).slice(1).map(function(e){return parseInt(e,10)}).map(function(e){return e.toString(16)}).join("");return l.appendChild(r),l.appendChild(a),l.appendChild(i),A.appendChild(l),fetch("/namer/lang/en/name?colour="+u).then(function(e){return e.json()}).then(function(e){i.className="black",i.textContent=e.colours[0].name.replace("_"," ")})})))}}});